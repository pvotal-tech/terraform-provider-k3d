---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "k3d_cluster Resource - terraform-provider-k3d"
subcategory: ""
description: |-
  Cluster resource in k3d.
---

# k3d_cluster (Resource)

Cluster resource in k3d.

## Example Usage

```terraform
resource "k3d_cluster" "mycluster" {
  name    = "mycluster"
  servers = 1
  agents  = 2

  kube_api {
    host      = "myhost.my.domain"
    host_ip   = "127.0.0.1"
    host_port = 6445
  }

  image   = "rancher/k3s:v1.20.4-k3s1"
  network = "my-custom-net"
  token   = "superSecretToken"

  volume {
    source      = "/my/host/path"
    destination = "/path/in/node"
    node_filters = [
      "server[0]",
      "agent[*]",
    ]
  }

  port {
    host_port      = 8080
    container_port = 80
    node_filters = [
      "loadbalancer",
    ]
  }

  label {
    key   = "foo"
    value = "bar"
    node_filters = [
      "agent[1]",
    ]
  }

  env {
    key   = "bar"
    value = "baz"
    node_filters = [
      "server[0]",
    ]
  }

  registries {
    create = {
      name      = "my-registry"
      host      = "my-registry.local"
      image     = "docker.io/some/registry"
      host_port = "5001"
    }
    use = [
      "k3d-myotherregistry:5000"
    ]
    config = <<EOF
mirrors:
  "my.company.registry":
    endpoint:
      - http://my.company.registry:5000
EOF
  }

  k3d {
    disable_load_balancer = false
    disable_image_volume  = false
  }

  k3s {
    extra_args = [{
      arg          = "--tls-san=my.host.domain",
      node_filters = ["agent"]
    }]
  }

  kubeconfig {
    update_default_kubeconfig = true
    switch_current_context    = true
  }

  runtime {
    gpu_request = "all"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Cluster name.

### Optional

- `agents` (Number) Specify how many agents you want to create.
- `env` (Block List) Add environment variables to nodes. (see [below for nested schema](#nestedblock--env))
- `image` (String) Specify k3s image that you want to use for the nodes.
- `k3d` (Block List, Max: 1) k3d runtime settings. (see [below for nested schema](#nestedblock--k3d))
- `k3s` (Block List, Max: 1) Options passed on to k3s itself. (see [below for nested schema](#nestedblock--k3s))
- `kube_api` (Block List, Max: 1) (see [below for nested schema](#nestedblock--kube_api))
- `kubeconfig` (Block List, Max: 1) Manage the default kubeconfig (see [below for nested schema](#nestedblock--kubeconfig))
- `label` (Block List) Add label to node container. (see [below for nested schema](#nestedblock--label))
- `network` (String) Join an existing network.
- `port` (Block List) Map ports from the node containers to the host. (see [below for nested schema](#nestedblock--port))
- `registries` (Block List, Max: 1) Define how registries should be created or used. (see [below for nested schema](#nestedblock--registries))
- `runtime` (Block List, Max: 1) Runtime (Docker) specific options (see [below for nested schema](#nestedblock--runtime))
- `servers` (Number) Specify how many servers you want to create.
- `token` (String, Sensitive) Specify a cluster token. By default, we generate one.
- `volume` (Block List) Mount volumes into the nodes. (see [below for nested schema](#nestedblock--volume))

### Read-Only

- `credentials` (List of Object, Sensitive) Cluster credentials. (see [below for nested schema](#nestedatt--credentials))
- `id` (String) The ID of this resource.

<a id="nestedblock--env"></a>
### Nested Schema for `env`

Required:

- `key` (String)

Optional:

- `node_filters` (List of String)
- `value` (String)


<a id="nestedblock--k3d"></a>
### Nested Schema for `k3d`

Optional:

- `disable_image_volume` (Boolean) Disable the creation of a volume for importing images.
- `disable_load_balancer` (Boolean) Disable the creation of a LoadBalancer in front of the server nodes.


<a id="nestedblock--k3s"></a>
### Nested Schema for `k3s`

Optional:

- `extra_args` (Block List) Additional args passed to the k3s command. (see [below for nested schema](#nestedblock--k3s--extra_args))

<a id="nestedblock--k3s--extra_args"></a>
### Nested Schema for `k3s.extra_args`

Optional:

- `arg` (String)
- `node_filters` (List of String)



<a id="nestedblock--kube_api"></a>
### Nested Schema for `kube_api`

Optional:

- `host` (String) Important for the `server` setting in the kubeconfig.
- `host_ip` (String) Where the Kubernetes API will be listening on.
- `host_port` (Number) Specify the Kubernetes API server port exposed on the LoadBalancer.


<a id="nestedblock--kubeconfig"></a>
### Nested Schema for `kubeconfig`

Optional:

- `switch_current_context` (Boolean) Directly switch the default kubeconfig's current-context to the new cluster's context.
- `update_default_kubeconfig` (Boolean) Directly update the default kubeconfig with the new cluster's context.


<a id="nestedblock--label"></a>
### Nested Schema for `label`

Required:

- `key` (String)

Optional:

- `node_filters` (List of String)
- `value` (String)


<a id="nestedblock--port"></a>
### Nested Schema for `port`

Required:

- `container_port` (Number)

Optional:

- `host` (String)
- `host_port` (Number)
- `node_filters` (List of String)
- `protocol` (String)


<a id="nestedblock--registries"></a>
### Nested Schema for `registries`

Optional:

- `config` (String) Specify path to an extra registries.yaml file.
- `create` (Block List, Max: 1) Create a k3d-managed registry and connect it to the cluster. (see [below for nested schema](#nestedblock--registries--create))
- `use` (List of String) Connect to one or more k3d-managed registries running locally.

<a id="nestedblock--registries--create"></a>
### Nested Schema for `registries.create`

Optional:

- `host` (String) Hostname to link to the created registry.
- `host_port` (String) Host port exposed to access the registry.
- `image` (String) Docker image of the registry.
- `name` (String) Name of the registry to create.



<a id="nestedblock--runtime"></a>
### Nested Schema for `runtime`

Optional:

- `agents_memory` (String) Memory limit imposed on the agents nodes [From docker].
- `gpu_request` (String) GPU devices to add to the cluster node containers ('all' to pass all GPUs) [From docker].
- `servers_memory` (String) Memory limit imposed on the server nodes [From docker].


<a id="nestedblock--volume"></a>
### Nested Schema for `volume`

Required:

- `destination` (String)

Optional:

- `node_filters` (List of String)
- `source` (String)


<a id="nestedatt--credentials"></a>
### Nested Schema for `credentials`

Read-Only:

- `client_certificate` (String)
- `client_key` (String)
- `cluster_ca_certificate` (String)
- `host` (String)
- `raw` (String)


